{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{h06z:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"DriverHomepagePageModuleNgFactory\",(function(){return DriverHomepagePageModuleNgFactory}));var core=__webpack_require__(\"8Y7J\");class DriverHomepagePageModule{}var router_ngfactory=__webpack_require__(\"pMnS\"),core_ngfactory=__webpack_require__(\"oBZk\"),fesm5=__webpack_require__(\"ZZ/e\"),common=__webpack_require__(\"SVse\"),tslib_es6=__webpack_require__(\"mrSG\"),location_service=__webpack_require__(\"yHma\"),socket_service=__webpack_require__(\"5U9e\");class driver_homepage_page_DriverHomepagePage{constructor(locationService,route,socketService,storage){this.locationService=locationService,this.route=route,this.socketService=socketService,this.storage=storage,this.isUserLoggedIn=!1,this.directionsService=new google.maps.DirectionsService,this.directionsDisplay=new google.maps.DirectionsRenderer,this.storage.get(\"username\").then(val=>{null!=val&&(this.isUserLoggedIn=!0)}),this.initializeMap();const firstParam=this.route.snapshot.queryParamMap.get(\"data\");if(null!=firstParam){let message=JSON.parse(firstParam);this.message=message,this.phoneNumber=message.phoneNumber,\"true\"==this.route.snapshot.queryParamMap.get(\"driveIsStarted\")&&(this.isDriveStarted=!0),this.directionsDisplay.setMap(this.map),this.populateAddress(this.message)}}ngAfterContentInit(){}calculateAndDisplayRoute(){const that=this;this.directionsService.route({origin:this.fromAddress,destination:this.toAddress,travelMode:\"DRIVING\"},(response,status)=>{\"OK\"===status?that.directionsDisplay.setDirections(response):window.alert(\"Directions request failed due to \"+status)})}addYourLocationButton(map,marker){var controlDiv=document.createElement(\"div\"),firstChild=document.createElement(\"button\");firstChild.style.backgroundColor=\"#fff\",firstChild.style.border=\"none\",firstChild.style.outline=\"none\",firstChild.style.width=\"28px\",firstChild.style.height=\"28px\",firstChild.style.borderRadius=\"2px\",firstChild.style.boxShadow=\"0 1px 4px rgba(0,0,0,0.3)\",firstChild.style.cursor=\"pointer\",firstChild.style.marginLEFT=\"10px\",firstChild.style.padding=\"0\",firstChild.title=\"Your Location\",controlDiv.appendChild(firstChild);var secondChild=document.createElement(\"div\");secondChild.style.margin=\"5px\",secondChild.style.width=\"18px\",secondChild.style.height=\"18px\",secondChild.style.backgroundImage=\"url(https://maps.gstatic.com/tactile/mylocation/mylocation-sprite-2x.png)\",secondChild.style.backgroundSize=\"180px 18px\",secondChild.style.backgroundPosition=\"0 0\",secondChild.style.backgroundRepeat=\"no-repeat\",firstChild.appendChild(secondChild),google.maps.event.addListener(map,\"center_changed\",(function(){secondChild.style[\"background-position\"]=\"0 0\"})),firstChild.addEventListener(\"click\",(function(){var imgX=0,animationInterval=setInterval((function(){secondChild.style[\"background-position\"]=(imgX=-imgX-18)+\"px 0\"}),500);navigator.geolocation?navigator.geolocation.getCurrentPosition((function(position){var latlng=new google.maps.LatLng(position.coords.latitude,position.coords.longitude);map.setCenter(latlng),clearInterval(animationInterval),secondChild.style[\"background-position\"]=\"-144px 0\"})):(clearInterval(animationInterval),secondChild.style[\"background-position\"]=\"0 0\")})),controlDiv.index=1,map.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(controlDiv)}populateAddress(message){return tslib_es6.b(this,void 0,void 0,(function*(){var fromAddress=yield this.locationService.getReverseGeocode(message.fromLat,message.fromLong);this.fromAddress=fromAddress[0].thoroughfare+\",\"+fromAddress[0].subThoroughfare+\",\"+fromAddress[0].locality;var toAddress=yield this.locationService.getReverseGeocode(message.toLat,message.toLong);this.toAddress=toAddress[0].thoroughfare+\",\"+toAddress[0].subThoroughfare+\",\"+toAddress[0].locality,this.calculateAndDisplayRoute()}))}initializeMap(){return tslib_es6.b(this,void 0,void 0,(function*(){this.currentLocation=yield this.locationService.getUserPosition();var directionsDisplay=new google.maps.DirectionsRenderer;this.map=new google.maps.Map(this.mapElement.nativeElement,{center:{lat:this.currentLocation.coords.latitude,lng:this.currentLocation.coords.longitude},zoom:16,styles:[{elementType:\"geometry\",stylers:[{color:\"#242f3e\"}]},{elementType:\"labels.text.fill\",stylers:[{color:\"#746855\"}]},{elementType:\"labels.text.stroke\",stylers:[{color:\"#242f3e\"}]},{featureType:\"administrative.locality\",elementType:\"labels.text.fill\",stylers:[{color:\"#d59563\"}]},{featureType:\"poi\",elementType:\"labels.text.fill\",stylers:[{color:\"#d59563\"}]},{featureType:\"poi.park\",elementType:\"geometry\",stylers:[{color:\"#263c3f\"}]},{featureType:\"poi.park\",elementType:\"labels.text.fill\",stylers:[{color:\"#6b9a76\"}]},{featureType:\"road\",elementType:\"geometry\",stylers:[{color:\"#38414e\"}]},{featureType:\"road\",elementType:\"geometry.stroke\",stylers:[{color:\"#212a37\"}]},{featureType:\"road\",elementType:\"labels.text.fill\",stylers:[{color:\"#9ca5b3\"}]},{featureType:\"road.highway\",elementType:\"geometry\",stylers:[{color:\"#746855\"}]},{featureType:\"road.highway\",elementType:\"geometry.stroke\",stylers:[{color:\"#1f2835\"}]},{featureType:\"road.highway\",elementType:\"labels.text.fill\",stylers:[{color:\"#f3d19c\"}]},{featureType:\"transit\",elementType:\"geometry\",stylers:[{color:\"#2f3948\"}]},{featureType:\"transit.station\",elementType:\"labels.text.fill\",stylers:[{color:\"#d59563\"}]},{featureType:\"water\",elementType:\"geometry\",stylers:[{color:\"#17263c\"}]},{featureType:\"water\",elementType:\"labels.text.fill\",stylers:[{color:\"#515c6d\"}]},{featureType:\"water\",elementType:\"labels.text.stroke\",stylers:[{color:\"#17263c\"}]}]});var myMarker=new google.maps.Marker({map:this.map,animation:google.maps.Animation.DROP,position:new google.maps.LatLng(this.currentLocation.coords.latitude,this.currentLocation.coords.longitude)});this.addYourLocationButton(this.map,myMarker),this.directionsDisplay.setMap(this.map);var directionsService=new google.maps.DirectionsService;directionsDisplay.setMap(this.map),directionsDisplay=new google.maps.DirectionsRenderer,this.displayDirection(directionsService,directionsDisplay)}))}endDrive(){this.storage.get(\"username\").then(username=>{this.socketService.send(\"/server-receiver\",{type:\"customer\",messageType:\"FINISH_DRIVE\",driver:username,customer:this.message.customer})}),location.reload()}driverIsOnSpot(){this.storage.get(\"username\").then(username=>{this.socketService.send(\"/server-receiver\",{type:\"customer\",messageType:\"ON_SPOT\",driver:username,customer:this.message.customer})})}displayDirection(directionsService,directionsDisplay){directionsService.route({origin:new google.maps.LatLng(this.currentLocation.coords.latitude,this.currentLocation.coords.longitude),destination:this.toAddress,travelMode:\"DRIVING\"},(response,status)=>{\"OK\"===status&&directionsDisplay.setDirections(response)})}ngOnInit(){}callSOS(){return tslib_es6.b(this,void 0,void 0,(function*(){this.currentLocation=yield this.locationService.getUserPosition(),console.log(\"DSAD\"),this.storage.get(\"username\").then(username=>{this.storage.get(\"username\").then(phone=>{this.socketService.send(\"/server-receiver\",{type:\"customer\",messageType:\"SOS\",driver:username,phoneNumber:phone,fromLat:this.currentLocation.coords.latitude,fromLong:this.currentLocation.coords.longitude})})})}))}}var router=__webpack_require__(\"iInd\"),ionic_storage=__webpack_require__(\"xgBC\"),RenderType_DriverHomepagePage=core.zb({encapsulation:0,styles:[\".map[_ngcontent-%COMP%] {\\n      height: 47% !important;\\n    }\",[\".map[_ngcontent-%COMP%]{margin:20px}.buttons[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;border-bottom:1px solid #000;padding-bottom:15px;margin:20px}.buttons[_ngcontent-%COMP%]   .call-customer[_ngcontent-%COMP%]{--background:#46e169;color:#393939;font-size:13px;width:100px}.buttons[_ngcontent-%COMP%]   .finish-drive[_ngcontent-%COMP%]{--background:#393939;color:#46e169;font-size:13px;width:100px}.buttons[_ngcontent-%COMP%]   .end-drive[_ngcontent-%COMP%]{--background:#9c9cac;color:#fff;font-size:13px;width:100px}.drive-request[_ngcontent-%COMP%]{padding:0 20px}.drive-request[_ngcontent-%COMP%]   .location-from[_ngcontent-%COMP%]{padding-bottom:15px;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.drive-request[_ngcontent-%COMP%]   .location-from[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-weight:700;text-transform:uppercase;text-shadow:0 0 .3em rgba(0,0,0,.4);margin-bottom:10px;font-size:13px}.drive-request[_ngcontent-%COMP%]   .location-from[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{text-shadow:0 0 .3em rgba(0,0,0,.4);border:1px solid #000;box-shadow:6px 6px 18px 0 rgba(0,0,0,.3);height:40px;padding:10px;font-size:13px}.header-box[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;padding:10px}.header-box[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{text-shadow:0 0 .3em rgba(0,0,0,.4);--color:#000;text-transform:uppercase}.header-box[_ngcontent-%COMP%]   ion-menu-button[_ngcontent-%COMP%]{text-shadow:0 0 .3em rgba(0,0,0,.4);--color:#000;--background:#f4f0ec;width:50px;height:50px;border-radius:50%}.header-box[_ngcontent-%COMP%]   .sos[_ngcontent-%COMP%]{background:#dc143c;float:right;width:50px;height:50px;border-radius:50%;padding:0;margin:0 20px 0 0;color:#fff;font-weight:700}\"]],data:{}});function View_DriverHomepagePage_1(_l){return core.Vb(0,[(_l()(),core.Bb(0,0,null,null,1,\"button\",[[\"class\",\"sos\"]],null,[[null,\"click\"]],(function(_v,en,$event){var ad=!0;return\"click\"===en&&(ad=!1!==_v.component.callSOS()&&ad),ad}),null,null)),(_l()(),core.Tb(-1,null,[\"SOS\"]))],null,null)}function View_DriverHomepagePage_2(_l){return core.Vb(0,[(_l()(),core.Bb(0,0,null,null,2,\"ion-button\",[[\"class\",\"call-customer\"]],null,null,null,core_ngfactory.x,core_ngfactory.b)),core.Ab(1,49152,null,0,fesm5.k,[core.j,core.p,core.F],{href:[0,\"href\"]},null),(_l()(),core.Tb(-1,0,[\"Nazovi\"]))],(function(_ck,_v){_ck(_v,1,0,core.Fb(1,\"tel:\",_v.component.phoneNumber,\"\"))}),null)}function View_DriverHomepagePage_3(_l){return core.Vb(0,[(_l()(),core.Bb(0,0,null,null,2,\"ion-button\",[[\"class\",\"finish-drive\"]],null,[[null,\"click\"]],(function(_v,en,$event){var ad=!0;return\"click\"===en&&(ad=!1!==_v.component.driverIsOnSpot()&&ad),ad}),core_ngfactory.x,core_ngfactory.b)),core.Ab(1,49152,null,0,fesm5.k,[core.j,core.p,core.F],null,null),(_l()(),core.Tb(-1,0,[\"Na adresi\"]))],null,null)}function View_DriverHomepagePage_4(_l){return core.Vb(0,[(_l()(),core.Bb(0,0,null,null,2,\"ion-button\",[[\"class\",\"end-drive\"]],null,[[null,\"click\"]],(function(_v,en,$event){var ad=!0;return\"click\"===en&&(ad=!1!==_v.component.endDrive()&&ad),ad}),core_ngfactory.x,core_ngfactory.b)),core.Ab(1,49152,null,0,fesm5.k,[core.j,core.p,core.F],null,null),(_l()(),core.Tb(-1,0,[\"Završi\"]))],null,null)}function View_DriverHomepagePage_5(_l){return core.Vb(0,[(_l()(),core.Bb(0,0,null,null,10,\"div\",[[\"class\",\"drive-request\"]],null,null,null,null,null)),(_l()(),core.Bb(1,0,null,null,4,\"div\",[[\"class\",\"location-from\"]],null,null,null,null,null)),(_l()(),core.Bb(2,0,null,null,1,\"span\",[[\"class\",\"text\"]],null,null,null,null,null)),(_l()(),core.Tb(-1,null,[\"Polazište:\"])),(_l()(),core.Bb(4,0,null,null,1,\"span\",[[\"class\",\"value\"]],null,null,null,null,null)),(_l()(),core.Tb(5,null,[\"\",\"\"])),(_l()(),core.Bb(6,0,null,null,4,\"div\",[[\"class\",\"location-from\"]],null,null,null,null,null)),(_l()(),core.Bb(7,0,null,null,1,\"span\",[[\"class\",\"text\"]],null,null,null,null,null)),(_l()(),core.Tb(-1,null,[\"Odredište:\"])),(_l()(),core.Bb(9,0,null,null,1,\"span\",[[\"class\",\"value\"]],null,null,null,null,null)),(_l()(),core.Tb(10,null,[\"\",\"\"]))],null,(function(_ck,_v){var _co=_v.component;_ck(_v,5,0,_co.fromAddress),_ck(_v,10,0,_co.toAddress)}))}function View_DriverHomepagePage_0(_l){return core.Vb(0,[core.Rb(402653184,1,{mapElement:0}),(_l()(),core.Bb(1,0,null,null,13,\"ion-header\",[],null,null,null,core_ngfactory.B,core_ngfactory.f)),core.Ab(2,49152,null,0,fesm5.B,[core.j,core.p,core.F],{translucent:[0,\"translucent\"]},null),(_l()(),core.Bb(3,0,null,0,11,\"ion-toolbar\",[],null,null,null,core_ngfactory.R,core_ngfactory.v)),core.Ab(4,49152,null,0,fesm5.Cb,[core.j,core.p,core.F],null,null),(_l()(),core.Bb(5,0,null,0,9,\"div\",[[\"class\",\"header-box\"]],null,null,null,null,null)),(_l()(),core.Bb(6,0,null,null,3,\"ion-buttons\",[[\"slot\",\"start\"]],null,null,null,core_ngfactory.y,core_ngfactory.c)),core.Ab(7,49152,null,0,fesm5.l,[core.j,core.p,core.F],null,null),(_l()(),core.Bb(8,0,null,0,1,\"ion-menu-button\",[],null,null,null,core_ngfactory.H,core_ngfactory.m)),core.Ab(9,49152,null,0,fesm5.R,[core.j,core.p,core.F],null,null),(_l()(),core.Bb(10,0,null,null,2,\"ion-title\",[],null,null,null,core_ngfactory.Q,core_ngfactory.u)),core.Ab(11,49152,null,0,fesm5.Ab,[core.j,core.p,core.F],null,null),(_l()(),core.Tb(-1,0,[\"Mura Taxi\"])),(_l()(),core.qb(16777216,null,null,1,null,View_DriverHomepagePage_1)),core.Ab(14,16384,null,0,common.i,[core.W,core.S],{ngIf:[0,\"ngIf\"]},null),(_l()(),core.Bb(15,0,null,null,11,\"ion-content\",[[\"class\",\"mapp\"]],null,null,null,core_ngfactory.A,core_ngfactory.e)),core.Ab(16,49152,null,0,fesm5.u,[core.j,core.p,core.F],null,null),(_l()(),core.Bb(17,0,[[1,0],[\"mapElement\",1]],0,0,\"div\",[[\"class\",\"map\"]],null,null,null,null,null)),(_l()(),core.Bb(18,0,null,0,6,\"div\",[[\"class\",\"buttons\"]],null,null,null,null,null)),(_l()(),core.qb(16777216,null,null,1,null,View_DriverHomepagePage_2)),core.Ab(20,16384,null,0,common.i,[core.W,core.S],{ngIf:[0,\"ngIf\"]},null),(_l()(),core.qb(16777216,null,null,1,null,View_DriverHomepagePage_3)),core.Ab(22,16384,null,0,common.i,[core.W,core.S],{ngIf:[0,\"ngIf\"]},null),(_l()(),core.qb(16777216,null,null,1,null,View_DriverHomepagePage_4)),core.Ab(24,16384,null,0,common.i,[core.W,core.S],{ngIf:[0,\"ngIf\"]},null),(_l()(),core.qb(16777216,null,0,1,null,View_DriverHomepagePage_5)),core.Ab(26,16384,null,0,common.i,[core.W,core.S],{ngIf:[0,\"ngIf\"]},null)],(function(_ck,_v){var _co=_v.component;_ck(_v,2,0,!0),_ck(_v,14,0,_co.isUserLoggedIn),_ck(_v,20,0,_co.isDriveStarted),_ck(_v,22,0,_co.isDriveStarted),_ck(_v,24,0,_co.isDriveStarted),_ck(_v,26,0,_co.isDriveStarted)}),null)}function View_DriverHomepagePage_Host_0(_l){return core.Vb(0,[(_l()(),core.Bb(0,0,null,null,1,\"app-driver-homepage\",[],null,null,null,View_DriverHomepagePage_0,RenderType_DriverHomepagePage)),core.Ab(1,1163264,null,0,driver_homepage_page_DriverHomepagePage,[location_service.a,router.a,socket_service.a,ionic_storage.b],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var DriverHomepagePageNgFactory=core.xb(\"app-driver-homepage\",driver_homepage_page_DriverHomepagePage,View_DriverHomepagePage_Host_0,{},{},[]),fesm2015_forms=__webpack_require__(\"s7LF\");class DriverHomepagePageRoutingModule{}var DriverHomepagePageModuleNgFactory=core.yb(DriverHomepagePageModule,[],(function(_l){return core.Kb([core.Lb(512,core.m,core.jb,[[8,[router_ngfactory.a,DriverHomepagePageNgFactory]],[3,core.m],core.D]),core.Lb(4608,common.k,common.j,[core.z,[2,common.t]]),core.Lb(4608,fesm2015_forms.l,fesm2015_forms.l,[]),core.Lb(4608,fesm5.b,fesm5.b,[core.F,core.g]),core.Lb(4608,fesm5.Gb,fesm5.Gb,[fesm5.b,core.m,core.w]),core.Lb(4608,fesm5.Kb,fesm5.Kb,[fesm5.b,core.m,core.w]),core.Lb(1073742336,common.b,common.b,[]),core.Lb(1073742336,fesm2015_forms.k,fesm2015_forms.k,[]),core.Lb(1073742336,fesm2015_forms.d,fesm2015_forms.d,[]),core.Lb(1073742336,fesm5.Eb,fesm5.Eb,[]),core.Lb(1073742336,router.o,router.o,[[2,router.t],[2,router.m]]),core.Lb(1073742336,DriverHomepagePageRoutingModule,DriverHomepagePageRoutingModule,[]),core.Lb(1073742336,DriverHomepagePageModule,DriverHomepagePageModule,[]),core.Lb(1024,router.k,(function(){return[[{path:\"\",component:driver_homepage_page_DriverHomepagePage}]]}),[])])}))}}]);","extractedComments":[]}