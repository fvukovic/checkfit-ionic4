(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{h06z:function(e,l,n){"use strict";n.r(l),n.d(l,"DriverHomepagePageModuleNgFactory",(function(){return O}));var t=n("8Y7J");class o{}var r=n("pMnS"),i=n("oBZk"),s=n("ZZ/e"),u=n("SVse"),a=n("mrSG"),c=n("yHma"),d=n("5U9e");class p{constructor(e,l,n,t){this.locationService=e,this.route=l,this.socketService=n,this.storage=t,this.isUserLoggedIn=!1,this.directionsService=new google.maps.DirectionsService,this.directionsDisplay=new google.maps.DirectionsRenderer,this.storage.get("username").then(e=>{null!=e&&(this.isUserLoggedIn=!0)}),this.initializeMap();const o=this.route.snapshot.queryParamMap.get("data");if(null!=o){let e=JSON.parse(o);this.message=e,this.phoneNumber=e.phoneNumber,"true"==this.route.snapshot.queryParamMap.get("driveIsStarted")&&(this.isDriveStarted=!0),this.directionsDisplay.setMap(this.map),this.populateAddress(this.message)}}ngAfterContentInit(){}calculateAndDisplayRoute(){const e=this;this.directionsService.route({origin:this.fromAddress,destination:this.toAddress,travelMode:"DRIVING"},(l,n)=>{"OK"===n?e.directionsDisplay.setDirections(l):window.alert("Directions request failed due to "+n)})}addYourLocationButton(e,l){var n=document.createElement("div"),t=document.createElement("button");t.style.backgroundColor="#fff",t.style.border="none",t.style.outline="none",t.style.width="28px",t.style.height="28px",t.style.borderRadius="2px",t.style.boxShadow="0 1px 4px rgba(0,0,0,0.3)",t.style.cursor="pointer",t.style.marginLEFT="10px",t.style.padding="0",t.title="Your Location",n.appendChild(t);var o=document.createElement("div");o.style.margin="5px",o.style.width="18px",o.style.height="18px",o.style.backgroundImage="url(https://maps.gstatic.com/tactile/mylocation/mylocation-sprite-2x.png)",o.style.backgroundSize="180px 18px",o.style.backgroundPosition="0 0",o.style.backgroundRepeat="no-repeat",t.appendChild(o),google.maps.event.addListener(e,"center_changed",(function(){o.style["background-position"]="0 0"})),t.addEventListener("click",(function(){var l=0,n=setInterval((function(){o.style["background-position"]=(l=-l-18)+"px 0"}),500);navigator.geolocation?navigator.geolocation.getCurrentPosition((function(l){var t=new google.maps.LatLng(l.coords.latitude,l.coords.longitude);e.setCenter(t),clearInterval(n),o.style["background-position"]="-144px 0"})):(clearInterval(n),o.style["background-position"]="0 0")})),n.index=1,e.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(n)}populateAddress(e){return a.b(this,void 0,void 0,(function*(){var l=yield this.locationService.getReverseGeocode(e.fromLat,e.fromLong);this.fromAddress=l[0].thoroughfare+","+l[0].subThoroughfare+","+l[0].locality;var n=yield this.locationService.getReverseGeocode(e.toLat,e.toLong);this.toAddress=n[0].thoroughfare+","+n[0].subThoroughfare+","+n[0].locality,this.calculateAndDisplayRoute()}))}initializeMap(){return a.b(this,void 0,void 0,(function*(){this.currentLocation=yield this.locationService.getUserPosition();var e=new google.maps.DirectionsRenderer;this.map=new google.maps.Map(this.mapElement.nativeElement,{center:{lat:this.currentLocation.coords.latitude,lng:this.currentLocation.coords.longitude},zoom:16,styles:[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}]});var l=new google.maps.Marker({map:this.map,animation:google.maps.Animation.DROP,position:new google.maps.LatLng(this.currentLocation.coords.latitude,this.currentLocation.coords.longitude)});this.addYourLocationButton(this.map,l),this.directionsDisplay.setMap(this.map);var n=new google.maps.DirectionsService;e.setMap(this.map),e=new google.maps.DirectionsRenderer,this.displayDirection(n,e)}))}endDrive(){this.storage.get("username").then(e=>{this.socketService.send("/server-receiver",{type:"customer",messageType:"FINISH_DRIVE",driver:e,customer:this.message.customer})}),location.reload()}driverIsOnSpot(){this.storage.get("username").then(e=>{this.socketService.send("/server-receiver",{type:"customer",messageType:"ON_SPOT",driver:e,customer:this.message.customer})})}displayDirection(e,l){e.route({origin:new google.maps.LatLng(this.currentLocation.coords.latitude,this.currentLocation.coords.longitude),destination:this.toAddress,travelMode:"DRIVING"},(e,n)=>{"OK"===n&&l.setDirections(e)})}ngOnInit(){}callSOS(){return a.b(this,void 0,void 0,(function*(){this.currentLocation=yield this.locationService.getUserPosition(),console.log("DSAD"),this.storage.get("username").then(e=>{this.storage.get("username").then(l=>{this.socketService.send("/server-receiver",{type:"customer",messageType:"SOS",driver:e,phoneNumber:l,fromLat:this.currentLocation.coords.latitude,fromLong:this.currentLocation.coords.longitude})})})}))}}var g=n("iInd"),b=n("xgBC"),m=t.zb({encapsulation:0,styles:[".map[_ngcontent-%COMP%] {\n      height: 47% !important;\n    }",[".map[_ngcontent-%COMP%]{margin:20px}.buttons[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;border-bottom:1px solid #000;padding-bottom:15px;margin:20px}.buttons[_ngcontent-%COMP%]   .call-customer[_ngcontent-%COMP%]{--background:#46e169;color:#393939;font-size:13px;width:100px}.buttons[_ngcontent-%COMP%]   .finish-drive[_ngcontent-%COMP%]{--background:#393939;color:#46e169;font-size:13px;width:100px}.buttons[_ngcontent-%COMP%]   .end-drive[_ngcontent-%COMP%]{--background:#9c9cac;color:#fff;font-size:13px;width:100px}.drive-request[_ngcontent-%COMP%]{padding:0 20px}.drive-request[_ngcontent-%COMP%]   .location-from[_ngcontent-%COMP%]{padding-bottom:15px;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.drive-request[_ngcontent-%COMP%]   .location-from[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-weight:700;text-transform:uppercase;text-shadow:0 0 .3em rgba(0,0,0,.4);margin-bottom:10px;font-size:13px}.drive-request[_ngcontent-%COMP%]   .location-from[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{text-shadow:0 0 .3em rgba(0,0,0,.4);border:1px solid #000;box-shadow:6px 6px 18px 0 rgba(0,0,0,.3);height:40px;padding:10px;font-size:13px}.header-box[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;padding:10px}.header-box[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{text-shadow:0 0 .3em rgba(0,0,0,.4);--color:#000;text-transform:uppercase}.header-box[_ngcontent-%COMP%]   ion-menu-button[_ngcontent-%COMP%]{text-shadow:0 0 .3em rgba(0,0,0,.4);--color:#000;--background:#f4f0ec;width:50px;height:50px;border-radius:50%}.header-box[_ngcontent-%COMP%]   .sos[_ngcontent-%COMP%]{background:#dc143c;float:right;width:50px;height:50px;border-radius:50%;padding:0;margin:0 20px 0 0;color:#fff;font-weight:700}"]],data:{}});function h(e){return t.Vb(0,[(e()(),t.Bb(0,0,null,null,1,"button",[["class","sos"]],null,[[null,"click"]],(function(e,l,n){var t=!0;return"click"===l&&(t=!1!==e.component.callSOS()&&t),t}),null,null)),(e()(),t.Tb(-1,null,["SOS"]))],null,null)}function y(e){return t.Vb(0,[(e()(),t.Bb(0,0,null,null,2,"ion-button",[["class","call-customer"]],null,null,null,i.x,i.b)),t.Ab(1,49152,null,0,s.k,[t.j,t.p,t.F],{href:[0,"href"]},null),(e()(),t.Tb(-1,0,["Nazovi"]))],(function(e,l){e(l,1,0,t.Fb(1,"tel:",l.component.phoneNumber,""))}),null)}function f(e){return t.Vb(0,[(e()(),t.Bb(0,0,null,null,2,"ion-button",[["class","finish-drive"]],null,[[null,"click"]],(function(e,l,n){var t=!0;return"click"===l&&(t=!1!==e.component.driverIsOnSpot()&&t),t}),i.x,i.b)),t.Ab(1,49152,null,0,s.k,[t.j,t.p,t.F],null,null),(e()(),t.Tb(-1,0,["Na adresi"]))],null,null)}function v(e){return t.Vb(0,[(e()(),t.Bb(0,0,null,null,2,"ion-button",[["class","end-drive"]],null,[[null,"click"]],(function(e,l,n){var t=!0;return"click"===l&&(t=!1!==e.component.endDrive()&&t),t}),i.x,i.b)),t.Ab(1,49152,null,0,s.k,[t.j,t.p,t.F],null,null),(e()(),t.Tb(-1,0,["Zavr\u0161i"]))],null,null)}function x(e){return t.Vb(0,[(e()(),t.Bb(0,0,null,null,10,"div",[["class","drive-request"]],null,null,null,null,null)),(e()(),t.Bb(1,0,null,null,4,"div",[["class","location-from"]],null,null,null,null,null)),(e()(),t.Bb(2,0,null,null,1,"span",[["class","text"]],null,null,null,null,null)),(e()(),t.Tb(-1,null,["Polazi\u0161te:"])),(e()(),t.Bb(4,0,null,null,1,"span",[["class","value"]],null,null,null,null,null)),(e()(),t.Tb(5,null,["",""])),(e()(),t.Bb(6,0,null,null,4,"div",[["class","location-from"]],null,null,null,null,null)),(e()(),t.Bb(7,0,null,null,1,"span",[["class","text"]],null,null,null,null,null)),(e()(),t.Tb(-1,null,["Odredi\u0161te:"])),(e()(),t.Bb(9,0,null,null,1,"span",[["class","value"]],null,null,null,null,null)),(e()(),t.Tb(10,null,["",""]))],null,(function(e,l){var n=l.component;e(l,5,0,n.fromAddress),e(l,10,0,n.toAddress)}))}function T(e){return t.Vb(0,[t.Rb(402653184,1,{mapElement:0}),(e()(),t.Bb(1,0,null,null,13,"ion-header",[],null,null,null,i.B,i.f)),t.Ab(2,49152,null,0,s.B,[t.j,t.p,t.F],{translucent:[0,"translucent"]},null),(e()(),t.Bb(3,0,null,0,11,"ion-toolbar",[],null,null,null,i.R,i.v)),t.Ab(4,49152,null,0,s.Cb,[t.j,t.p,t.F],null,null),(e()(),t.Bb(5,0,null,0,9,"div",[["class","header-box"]],null,null,null,null,null)),(e()(),t.Bb(6,0,null,null,3,"ion-buttons",[["slot","start"]],null,null,null,i.y,i.c)),t.Ab(7,49152,null,0,s.l,[t.j,t.p,t.F],null,null),(e()(),t.Bb(8,0,null,0,1,"ion-menu-button",[],null,null,null,i.H,i.m)),t.Ab(9,49152,null,0,s.R,[t.j,t.p,t.F],null,null),(e()(),t.Bb(10,0,null,null,2,"ion-title",[],null,null,null,i.Q,i.u)),t.Ab(11,49152,null,0,s.Ab,[t.j,t.p,t.F],null,null),(e()(),t.Tb(-1,0,["Mura Taxi"])),(e()(),t.qb(16777216,null,null,1,null,h)),t.Ab(14,16384,null,0,u.i,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(e()(),t.Bb(15,0,null,null,11,"ion-content",[["class","mapp"]],null,null,null,i.A,i.e)),t.Ab(16,49152,null,0,s.u,[t.j,t.p,t.F],null,null),(e()(),t.Bb(17,0,[[1,0],["mapElement",1]],0,0,"div",[["class","map"]],null,null,null,null,null)),(e()(),t.Bb(18,0,null,0,6,"div",[["class","buttons"]],null,null,null,null,null)),(e()(),t.qb(16777216,null,null,1,null,y)),t.Ab(20,16384,null,0,u.i,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(e()(),t.qb(16777216,null,null,1,null,f)),t.Ab(22,16384,null,0,u.i,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(e()(),t.qb(16777216,null,null,1,null,v)),t.Ab(24,16384,null,0,u.i,[t.W,t.S],{ngIf:[0,"ngIf"]},null),(e()(),t.qb(16777216,null,0,1,null,x)),t.Ab(26,16384,null,0,u.i,[t.W,t.S],{ngIf:[0,"ngIf"]},null)],(function(e,l){var n=l.component;e(l,2,0,!0),e(l,14,0,n.isUserLoggedIn),e(l,20,0,n.isDriveStarted),e(l,22,0,n.isDriveStarted),e(l,24,0,n.isDriveStarted),e(l,26,0,n.isDriveStarted)}),null)}function k(e){return t.Vb(0,[(e()(),t.Bb(0,0,null,null,1,"app-driver-homepage",[],null,null,null,T,m)),t.Ab(1,1163264,null,0,p,[c.a,g.a,d.a,b.b],null,null)],(function(e,l){e(l,1,0)}),null)}var w=t.xb("app-driver-homepage",p,k,{},{},[]),L=n("s7LF");class S{}var O=t.yb(o,[],(function(e){return t.Kb([t.Lb(512,t.m,t.jb,[[8,[r.a,w]],[3,t.m],t.D]),t.Lb(4608,u.k,u.j,[t.z,[2,u.t]]),t.Lb(4608,L.l,L.l,[]),t.Lb(4608,s.b,s.b,[t.F,t.g]),t.Lb(4608,s.Gb,s.Gb,[s.b,t.m,t.w]),t.Lb(4608,s.Kb,s.Kb,[s.b,t.m,t.w]),t.Lb(1073742336,u.b,u.b,[]),t.Lb(1073742336,L.k,L.k,[]),t.Lb(1073742336,L.d,L.d,[]),t.Lb(1073742336,s.Eb,s.Eb,[]),t.Lb(1073742336,g.o,g.o,[[2,g.t],[2,g.m]]),t.Lb(1073742336,S,S,[]),t.Lb(1073742336,o,o,[]),t.Lb(1024,g.k,(function(){return[[{path:"",component:p}]]}),[])])}))}}]);